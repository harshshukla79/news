<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-17689374156">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-17689374156');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Daily News | Finance Today News</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <meta name="description" content="Access the dynamic, real-time archive of daily news, analysis, and reports focusing on finance, retirement, and health—tailored for the discerning 45+ desktop audience in the USA.">
    <meta name="keywords" content="daily news, retirement news, finance update, health trends 45+, political analysis, us market news, global stability reports, authoritative news">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7f7f7; }
        .masthead-bg { background-color: #0d47a1; color: white; } /* Deep Blue for Authority */
        .article-summary-font { font-size: 1.15rem; line-height: 1.6; }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #0d47a1;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-900">
    <!-- Header/Masthead - Kept Intact from Homepage -->
    <header class="masthead-bg shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col lg:flex-row justify-between items-center">
                <h1 class="text-5xl font-extrabold tracking-tight">
                    <a href="index.html" class="hover:text-gray-200 transition duration-150">The Global Chronicle</a>
                </h1>
                <nav class="mt-4 lg:mt-0 space-x-6 text-xl font-medium">
                    <a href="index.html" class="hover:text-red-300 border-b-2 border-transparent transition duration-150 pb-1">Home</a>
                    <!-- Active link -->
                    <a href="daily_news.html" class="hover:text-red-300 border-b-2 border-red-500 transition duration-150 pb-1">Daily News</a>
                    <a href="privacy.html" class="hover:text-red-300 transition duration-150 pb-1">Privacy</a>
                    <a href="terms.html" class="hover:text-red-300 transition duration-150 pb-1">Terms</a>
                    <a href="contact.html" class="hover:text-red-300 transition duration-150 pb-1">Contact</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content Area: Daily News List -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-10">
        <h2 class="text-4xl font-extrabold text-gray-900 border-b-4 border-red-600 pb-3 mb-8">
            Today's Focused News Feed
        </h2>

        <div class="grid lg:grid-cols-3 gap-10">
            <!-- Left Column: Dynamic News List -->
            <div id="news-container" class="lg:col-span-2 space-y-8">
                
                <!-- Dynamic content loading area -->
                <div id="loading-state" class="flex flex-col items-center justify-center p-12 bg-white rounded-xl shadow-lg">
                    <div class="loading-spinner"></div>
                    <p class="mt-4 text-xl text-gray-700 font-semibold">Fetching today's authoritative reports...</p>
                </div>

                <!-- Articles will be inserted here -->
            </div>

            <!-- Right Column: Sidebar (Only Categories) -->
            <aside class="lg:col-span-1 space-y-8">
                
                <!-- Category Navigation -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-red-600">
                    <h3 class="text-2xl font-bold mb-4 border-b pb-2">Browse Categories</h3>
                    <ul class="space-y-3 text-lg" id="category-list">
                        <!-- Dynamic content will populate or use static links -->
                        <li><a href="#" class="hover:text-red-600 transition duration-150 font-medium">U.S. Politics</a></li>
                        <li><a href="#" class="hover:text-red-600 transition duration-150 font-medium">Retirement & Finance</a></li>
                        <li><a href="#" class="hover:text-red-600 transition duration-150 font-medium">Health & Longevity</a></li>
                        <li><a href="#" class="hover:text-red-600 transition duration-150 font-medium">World Stability</a></li>
                    </ul>
                </div>
            </aside>
        </div>
    </main>

    <!-- Footer - Kept Intact from Homepage -->
    <footer class="masthead-bg mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-white text-center">
            <p class="text-xl font-bold mb-4">The Global Chronicle — Reliable. Unbiased. Authoritative.</p>
            <div class="flex justify-center space-x-6 text-lg font-medium">
                <a href="privacy.html" class="hover:text-red-300 transition duration-150">Privacy Policy</a>
                <span class="text-red-400">|</span>
                <a href="terms.html" class="hover:text-red-300 transition duration-150">Terms & Conditions</a>
                <span class="text-red-400">|</span>
                <a href="contact.html" class="hover:text-red-300 transition duration-150">Contact Us</a>
                <span class="text-red-400">|</span>
                <a href="daily_news.html" class="hover:text-red-300 transition duration-150">Archives</a>
            </div>
            <p class="mt-4 text-sm text-gray-300">&copy; 2025 The Global Chronicle. All rights reserved. Content provided for informational purposes only.</p>
        </div>
    </footer>

    <script>
        // --- GEMINI API INTEGRATION (TEXT) ---
        
        const API_KEY = ""; // Canvas will automatically provide the API key
        const TEXT_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;
        const IMAGE_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${API_KEY}`;
        const MAX_RETRIES = 5;

        // Elements
        const newsContainer = document.getElementById('news-container');
        const loadingState = document.getElementById('loading-state');

        // System Instruction: Tailored for 45+ US desktop clicks (Finance, Health, Stability)
        const systemPrompt = `You are a world-class, authoritative news editor for a high-end US publication, "The Global Chronicle," targeting a sophisticated, desktop-using audience aged 45 and over.
        Your task is to generate five distinct, highly engaging news summaries structured in JSON format.
        
        CRITICAL FOCUS: The topics must be highly relevant and clickable for this demographic, focusing on:
        1. Retirement planning, financial stability, and investment strategies.
        2. Health, longevity, and age-related medical breakthroughs.
        3. National political stability and major legislative impacts (e.g., Social Security, Medicare).
        4. Global economic trends and geopolitical events affecting US stability.

        Each summary must be concise (3-4 sentences max), compelling, and sound like real news. DO NOT use any markdown formatting (like asterisks or bolding) in the JSON values, as the HTML will format it.

        The JSON output MUST follow this schema exactly:
        `;

        const userQuery = "Generate five current news articles summaries covering topics relevant to 45+ American adults today (e.g., retirement, healthcare costs, political developments, global economy).";

        // JSON Schema for Structured Output
        const responseSchema = {
            type: "ARRAY",
            items: {
                type: "OBJECT",
                properties: {
                    "headline": { "type": "STRING", "description": "The main, compelling headline (max 10 words)." },
                    "category": { "type": "STRING", "description": "Category: Finance, Health, Politics, or Global." },
                    "summary": { "type": "STRING", "description": "A 3-4 sentence concise summary of the article's core finding or question." },
                    "link": { "type": "STRING", "description": "A placeholder link for the full article, always using 'article.html'" }
                },
                "required": ["headline", "category", "summary", "link"]
            }
        };

        // --- COMMON FETCH FUNCTION WITH EXPONENTIAL BACKOFF ---

        async function fetchWithRetry(url, payload, retries = 0) {
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    if (response.status === 429 && retries < MAX_RETRIES) {
                        const delay = Math.pow(2, retries) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        return fetchWithRetry(url, payload, retries + 1);
                    }
                    throw new Error(`API call failed with status: ${response.status}`);
                }

                return response.json();

            } catch (error) {
                console.error("Error during API fetch:", error);
                throw error;
            }
        }

        // --- IMAGE GENERATION FUNCTION ---

        async function generateArticleImage(headline) {
            // Generate a detailed prompt for Imagen 3
            const imagePrompt = `A high-quality, professional, photojournalistic image illustrating a key concept from the news headline: "${headline}". The style should be authoritative and trustworthy, suitable for a major US newspaper. Focus on clarity and concept.`;
            
            const payload = { 
                instances: { prompt: imagePrompt }, 
                parameters: { "sampleCount": 1, "aspectRatio": "16:9" } 
            };
            
            try {
                const result = await fetchWithRetry(IMAGE_API_URL, payload);
                const base64Data = result?.predictions?.[0]?.bytesBase64Encoded;
                
                if (base64Data) {
                    return `data:image/png;base64,${base64Data}`;
                }
            } catch (error) {
                console.warn(`Could not generate image for headline: ${headline}`);
                return null;
            }
            return null;
        }


        // --- MAIN RENDERING FUNCTION ---

        async function loadDailyNews() {
            loadingState.style.display = 'flex'; // Show loading spinner
            let articles = [];

            try {
                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: responseSchema
                    }
                };
                
                const result = await fetchWithRetry(TEXT_API_URL, payload);
                const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                
                if (jsonText) {
                    articles = JSON.parse(jsonText);
                }
            } catch (error) {
                console.error("Failed to load or parse news data:", error);
                // Fallback to static mock data in case of failure
                articles = [
                    { headline: "Medicare Debate Stalls on Capitol Hill", category: "Politics", summary: "Key legislative leaders failed to reach consensus on future Medicare funding this week, raising concerns about potential premium increases for seniors. Experts warn that a prolonged debate could impact preventative care programs nationwide. The White House calls for immediate bipartisan talks to stabilize the crucial healthcare framework.", link: "article.html" },
                    { headline: "Inflation-Beating Annuities: A Must-Have for Retirement?", category: "Finance", summary: "Financial analysts are urging Americans over 50 to re-evaluate their portfolios, specifically focusing on fixed-index annuities designed to counteract persistent inflation. These products promise stability but carry complex fee structures that require careful review. This analysis details if the trade-off is worth the security.", link: "article.html" },
                    { headline: "New Study Links Simple Diet Change to Cognitive Longevity", category: "Health", summary: "A groundbreaking Harvard study published today found a strong correlation between a minor daily dietary adjustment and significantly reduced risk of age-related cognitive decline. The change involves increasing intake of a common, affordable nutrient. This finding offers a simple, non-pharmaceutical path to supporting brain health.", link: "article.html" }
                ];
            } finally {
                loadingState.style.display = 'none'; // Hide loading spinner
                renderArticles(articles);
            }
        }

        async function renderArticles(articles) {
            // Clear the news container, removing the loading state
            newsContainer.innerHTML = ''; 
            
            articles.forEach(async (article, index) => {
                // IMPORTANT: Encode the data to be safely passed in the URL
                const encodedHeadline = encodeURIComponent(article.headline);
                const encodedCategory = encodeURIComponent(article.category);
                const link = `article.html?headline=${encodedHeadline}&category=${encodedCategory}`; 

                const colorMap = {
                    "Finance": "border-red-600",
                    "Health": "border-green-600",
                    "Politics": "border-blue-600",
                    "Global": "border-yellow-600"
                };
                const borderColor = colorMap[article.category] || "border-gray-900";
                const imagePlaceholderId = `article-image-${index}`;

                // 1. Render the article structure with a placeholder for the image
                const articleHTML = `
                    <!-- News Article Item ${index + 1} -->
                    <article class="bg-white p-6 rounded-xl shadow-lg border-l-8 ${borderColor} transition hover:shadow-xl">
                        <p class="text-sm text-gray-500 mb-2 font-semibold uppercase">${article.category} | Today</p>
                        <h3 class="text-3xl font-bold mb-3 hover:text-red-600 transition duration-300">
                            <a href="${link}">${article.headline}</a>
                        </h3>
                        
                        <!-- Image Container Placeholder -->
                        <div id="${imagePlaceholderId}" class="w-full h-48 bg-gray-100 rounded-lg mb-4 flex items-center justify-center overflow-hidden">
                             <div class="loading-spinner w-10 h-10"></div>
                        </div>

                        <p class="article-summary-font mb-4 text-gray-700">
                            ${article.summary}
                        </p>
                        <a href="${link}" class="text-blue-700 font-semibold text-lg hover:underline">Read Full Report →</a>
                    </article>
                `;
                newsContainer.insertAdjacentHTML('beforeend', articleHTML);
                
                // 2. Asynchronously generate and insert the image
                const imageUrl = await generateArticleImage(article.headline);
                const imageElement = document.getElementById(imagePlaceholderId);
                
                if (imageUrl && imageElement) {
                    imageElement.innerHTML = `<a href="${link}"><img src="${imageUrl}" alt="${article.headline}" class="w-full h-full object-cover"></a>`;
                } else if (imageElement) {
                    // If image generation fails, use a clean placeholder text
                    imageElement.innerHTML = `<p class="text-sm text-gray-500">Visual content loading...</p>`;
                }
            });
        }

        // Start loading the news when the page is ready
        window.onload = loadDailyNews;
    </script>
</body>
</html>


